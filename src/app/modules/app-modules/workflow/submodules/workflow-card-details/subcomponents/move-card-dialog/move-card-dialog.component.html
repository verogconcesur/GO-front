<div class="move-card-dialog">
    <div class="move-card-dialog__header">
        <h2 class="mat-headline">{{ labels.moveCard | translate }}</h2>
        <button mat-icon-button class="move-card-dialog__header__close" (click)="close()">
            <mat-icon>close</mat-icon>
        </button>
    </div>
    <mat-divider></mat-divider>
    <div class="move-card-dialog__filter">
        <h3 class="mat-title">{{ labels.moveWhere | translate }}</h3>
        <div class="move-card-dialog__filter__form">
            <form class="smaller-mat-form-fields" fxLayout="row" fxLayoutAlign="end center" (ngSubmit)="filter()">
                <mat-form-field appearance="outline" class="smaller-mat-form-fields__no-margin">
                    <input
                        type="text"
                        matInput
                        [placeholder]="labels.filter | translate"
                        [formControl]="filterTextSearchControl"
                        (keyup.enter)="filter()"
                    />
                </mat-form-field>
            </form>
        </div>
        <div class="move-card-dialog__content">
            <ng-container *ngIf="view === 'MOVES_IN_THIS_WORKFLOW'">
                <h3>{{ labels.statesInThisWorkflow | translate | uppercase }}</h3>
            </ng-container>
            <ng-container *ngIf="view === 'MOVES_IN_OTHER_WORKFLOWS'">
                <h3>{{ labels.otherWorkflows | translate | uppercase }}</h3>
            </ng-container>
            <mat-tree [dataSource]="dataSource" [treeControl]="treeControl" class="workflow-states-tree">
                <mat-tree-node *matTreeNodeDef="let node" matTreeNodeToggle (click)="moveCardTo(node)">
                    <button mat-button>
                        <div>{{ node.name }}</div>
                        <mat-icon>keyboard_arrow_right</mat-icon>
                    </button>
                </mat-tree-node>
                <mat-nested-tree-node *matTreeNodeDef="let node; when: hasChild">
                    <div class="mat-tree-node mat-tree-group-node">
                        <button mat-button matTreeNodeToggle [attr.aria-label]="'Toggle ' + node.name">
                            <div>{{ node.name }}</div>
                            <mat-icon class="mat-icon-rtl-mirror">
                                {{ treeControl.isExpanded(node) ? "expand_more" : "chevron_right" }}
                            </mat-icon>
                        </button>
                    </div>
                    <div [class.workflow-states-tree-invisible]="!treeControl.isExpanded(node)" role="group">
                        <ng-container matTreeNodeOutlet></ng-container>
                    </div>
                </mat-nested-tree-node>
            </mat-tree>
        </div>
        <div class="move-card-dialog__footer">
            <button mat-stroked-button (click)="changeView()">
                <span *ngIf="view === 'MOVES_IN_THIS_WORKFLOW'">{{ labels.otherWorkflows | translate }}</span>
                <span *ngIf="view === 'MOVES_IN_OTHER_WORKFLOWS'">{{ labels.statesInThisWorkflow | translate }}</span>
            </button>
        </div>
    </div>
</div>
